# 插件(plugin)

> 究竟什么是插件？插件又哪几种？或者说哪几种粒度？
> 究竟该以何种方式提供？

## 插件开发

以 java 为例，某种意义上插件必须得独立于主工程进行开发。因此必须提供插件可以独立开发的环境

这个环境由 `starter` 来提供，`starter` 暂定支持两种环境，一种为 *主工程* 环境

另一种为 *插件* 环境。

主工程环境不做过多的赘述，关键是*插件*环境的提炼，插件环境必须能够让插件单独出来足够可以开发。

这里可以提供两种思路：

1. 模拟出一个 app 环境供插件进行开发，但是开发后被主应用加载后`可能会存在路由变化的情况`，
   但这很明显可以接受。但是其它的地方，诸如配置，类库皆可以被完整保留。
   
2. 将默认的 app 置于 starter 中，通过开发环境，如 `plugin`，`app`环境下的不同来提供不同的
   开发环境。
   
## 插件类型

以 `业务` 这个东西来区分插件，暂时将插件分为两类：

- 普通插件：含基础类库的插件，如 uploader 之类的，含类库，配置及其它，被装载到依赖库中，主动导入
  进行使用，如需更改可通过继承的方式进行定制。细粒度的插件

- 业务插件：含业务(服务接口)，可通过 http 方式进行访问的插件，含基础类库，配置，业务层，校验层及其它，
  会将它发布在 github 仓库上，不发布在 maven repository 或者 npm 上。供 clone 下来进行业务修改和
  二次开发。
  
当然，也可以根据其它的粒度层次来进行划分。

## 插件实现

暂时的想法，通过 `hook` 来实现，spring boot 有 listener，作用一致，叫法不同。

通过 `hook`，调用插件的加载。

待解决的问题：

1. 如何让插件的开发可以享用权限的控制
2. 如何让插件享受令牌的使用

-> 或许还是得需要将这些抽离到 `starter` 里面 -> 不可取

将逻辑仍然丢在核心库里面，将业务逻辑单独抽离出接口，让 demo 为其实现

目前可以让插件使用权限和行为日志等诸多的功能，但是其实现与主工程不同，不能够完全模拟，只能够在逻辑上保持一致